<html><head><meta name="viewport" content="width=device-width, initial-scale=1"><link href=//fonts.googleapis.com/css?family=Raleway:400,300,600 rel=stylesheet type=text/css><link rel="stylesheet" type="text/css" href="../common/css/normalize.css"><link rel="stylesheet" type="text/css" href="../common/css/skeleton.css"><link rel="stylesheet" type="text/css" href="../common/css/wiki.css"><script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script><title>Wifi shield v1.2</title><meta charset="utf-8"/></head><body><div class"container"><a href="../"><img src="../common/logo.png"/></a></div><div class="mw-content-ltr container" dir="ltr" id="mw-content-text" lang="en"><h1>Wifi shield v1.2</h1><center><img src="img/Wifi_shield_v1.1_front.png" width="400"/><img src="img/Wifi_shield_v1.1_back.png" width="400"/></center>

<h2> Overview</h2>
<p>
This WiFi shield features the RN171 TCP/IP module to allow your Arduino/Seeeduino to connect with up to 802.11b/g wireless networks. 
</p>
<p>
The shield's default communication protocol with the Arduino is UART/Serial, and you may select which digital pins (D0 to D7) to use for RX and TX with two jumper rows we've incorporated. The shield also has two on-board Grove connectors for I2C and Serial to allow the shield to be used with any of our Grove devices.
</p>
<p>
An on-board antenna allows the shield to cover a wider range and transmit stronger signals. The RN171 module supports TCP, UDP, FTP, and HTTP communication protocols to meet the needs of most wireless and Internet of Things (IoT) network projects e.g. smart home networks, robots control, personal weather stations.
</p>
<p>
The shield is very well documented with our examples below and its <a href="res/WiFly-RN-UM.pdf">user manual</a>.
</p>
<p>
<a href="http://www.seeedstudio.com/depot/Wifi-Shield-p-1220.html">Buy It Here: SKU: WLS06201P</a>
</p>
<h2>  Specification </h2>
<p><br/>
</p>
<table>
<tr>
<td width="200"> Operate voltage </td>
<td width="550"> 3.3~5.5 V
</td></tr>
<tr>
<td> Compatible board directly </td>
<td> Arduino Uno/Seeeduino
</td></tr>
<tr>
<td> Current </td>
<td> 25~400mA
</td></tr>
<tr>
<td> Transmit power </td>
<td> 0-10 dBm
</td></tr>
<tr>
<td> Frequency </td>
<td> 2402~2480 MHz
</td></tr>
<tr>
<td> Channal </td>
<td> 0~13
</td></tr>
<tr>
<td> Network rate </td>
<td> 1-11 Mbps for 802.11b/6-54Mbps for 802.11g
</td></tr>
<tr>
<td> Dimension </td>
<td> 60X56X19 mm
</td></tr>
<tr>
<td> Net Weight </td>
<td> 24±1 g
</td></tr>
<tr>
<td> Secure WiFi authentication </td>
<td> WEP-128, WPA-PSK (TKIP), WPA2-PSK (AES)
</td></tr>
<tr>
<td> Built-in networking applications </td>
<td> DHCP client, DNS client, ARP, ICMP ping, FTP, TELNET, HTTP, UDP, TCP
</td></tr>
<tr>
<td> Certification </td>
<td> RN171 : FCC, CE
</td></tr></table>
<p><br/>
</p>
<h2>  Shield Interface and Components </h2>
<p>The WiFi shield is compatible with any Arduino/Seeeduino development board as it only requires two digital pins of your choice between D0-D7 for UART/serial communication. To install, simply stack the shield on the Arduino/Seeeduino board.
</p>
<h3>  Overview </h3>
<div class="center"><div class="floatnone"><img src="img/Wifi_shield_v1.2_block1.png" width="700"/></div></div>
<p>
</p><ol>
<li><b>Serial Peripheral Interface (SPI) Connections (MOSI, SCK, MISO):</b> These pins are not connected to any of the Arduino's pins, they are independent and the logic level output/input of them is 3.3V. They can be used to communicate with the Arduino via SPI but a 3.3V logic converter between these pins and the Arduino's will be needed. The data rate in SPI mode can reach up to 2Mbps.<br/>
<b>RES_Wifi:</b> The Wifi shield has an on-board "Rest Button" for the RN-171 module, you may also reset the RN-171 via software by sending the reset command. Additionally, if you would like to connect this pin to the Arduino's digital 6 pin, simply solder the pad labeled "P5" on the shield.</li>
<li><b>RN171:</b> a super low power consumption wireless module with TCP/IP stack built in.</li>
<li><b>Antenna:</b> I.PEX connector.</li>
<li><b>RN171 breakout section:</b> 
The RN171 module has its own analog input and GPIO pins, which the shield provides access to via this breakout section.
The GPIO pins (IO3, IO7, IO8, and IO9) are 3.3V tolerant while the analog input pins (S_0 and S_1) can read 0-400mV (Do not exceed 1.2V).
The RN171 can be configured to use these pins by software or they may connected to other pins to use other RN171 functions such as adhoc mode.
The voltage of VCC is dependent on the supply power of the WiFi shield.
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:502px;"><img src="img/Wifi_shield_v1.2_breakout.png" width="500"/> <div class="thumbcaption">breakout section</div></div></div></div>
</li>
<li>
<b>UART/Serial Select area:</b> Two jumper rows to let you select which RX and TX pins you want to use to communicate with the Arduino.
</li>
<li>
<b>Grove connectors:</b> Analog I2C Grove (if using Arduino UNO or Seeeduino) for pins A4&amp;A5 and Digital Serial Grove for D8&amp;D9. The voltage VCC is dependent on the power supply of the board.</li>
</ol>
<h3>  Pins Used / Shield Compatibility </h3>
<p>
The WiFi shield uses any two digital pins of your choice between D0 and D7 to communicate with the RN171 WiFi module, however keep in mind that D0 and D1 are used by the Arduino for programming and serial communication purposes and using them might interfere with these two functions.
</p>
<p>
In the example codes in this page we use D2 and D3 as RX and TX for the shield. In this case, the jumper hats should be connected as shown below:
</p>
<p>
</p><div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:502px;"><img src="img/Wifi_shield_v1.1_pinout.png" width="500"/> <div class="thumbcaption">D2 selected for WIFI_TX, D3 selected for WIFI_RX</div></div></div></div>
<h3>  RN171 WiFi Module</h3>
<p>
The RN-171 is a standalone complete TCP/IP wireless networking module. Due to its small form factor and extremely low power consumption, the RN-171 is perfect for mobile wireless applications. It incorporates a 2.4GHz radio, 32-bit SPARC processor, TCP/IP stack, real-time clock, crypto accelerator, power management, and analog sensor interfaces.
</p>
<p>
In the simplest configuration the hardware only requires four connections (PWR, TX, RX and GND) to create a wireless WiFi data connection. Additionally, the analog sensor inputs of the RN171 can be used as analog input pins, their rating is 0-400 mV (Do not exceed 1.2V DC).
</p>
<p>
<b>Power:</b>  The operating voltage of the RN-171 module is 3.3VDC typically, so a voltage regulator and logic level translator are designed on the WiFi shield. The LD1117 regulator on the shield converts to 3.3VDC, which supplies the RN171 module. However, due to the auto judgement schematic of power supply, the RN-171 can be powered via both 3V3 pin and 5V pin. But the supply power would be 5v if providing both 3.3v and 5v to the board. If using with an Arduino/Seeeduino board simply stack the WiFi shield on the board.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:602px;"><img src="img/Wifi_shield_v1.1_communicate.png" width="600"/> <div class="thumbcaption">Diagram of how the RN171 module is interfaced to the Arduino</div></div></div></div>
<p><br/>
<b>GPIO_6 :</b> The GPIO6 pin of the RN171 WiFi module is by default only connected to the LED labeled D5 on the WiFi shield. This LED is used to display the status of the Access Point (AP) connection. If however, you would like to connect GPIO6 to digital pin 5 of the Arduino, simply solder the pad labeled "P6" on the WiFi shield.
</p><p><br/>
</p>
<h3> LED Status Indicators</h3>
<table>
<tr>
<th>Label</th><th>Description</th><th>Status</th><th>Hardware Connection</th>
</tr>
<tr>
<td>D5</td><td>Green LED. Indicates the association status.</td>
<td><b>OFF:</b> means the module is not associated with a network.<br/>
<b>Solid ON:</b> indicates that it is associated and Internet access is OK</td>
<td>Connected to GPIO6 of the RN171 module</td>
</tr>
<tr>
<td>D1</td>
<td>Red LED. Indicates the TCP/IP connection status.</td>
<td><b>Solid ON:</b> connected over TCP.<br/>
<p><b>Fast Toggle (2 times/second):</b> No IP address or module is in command mode.<br/>
</p><p><b>Slow Toggle (once/second):</b> IP address is OK.
</p>
</td>
<td>Connected to GPIO4 of the RN171 module</td>
</tr>
<tr>
<td>RST</td>
<td>Red LED. WiFi module reset status.</td>
<td><b>Solid ON:</b> The reset button (WIFI_RST) is been pressed.<br/></td>
<td>Connected to Reset of the RN171 module.</td>
</tr>
<tr>
<td>PWR</td>
<td>Green LED. Indicates WiFi module's power up status.</td>
<td><b>Solid ON:</b>The module/shield is powered up.</td>
<td>Connected to the 3.3V output of the LD1117 voltage regulator.</td>
</tr>
</table>
<h2>  WiFi Library </h2>
<p>We have created a library to help you interface with the shield, in this section we'll show you how to set up the library and introduce some of the functions.
</p>
<h3>  Setup </h3>
<ol><li> <i><a href="https://github.com/Seeed-Studio/WiFi_Shield">Download the library code as a zip file from the Wifi Shield github page.</a></i>
</li><li> <i>Unzip the downloaded file into your …/arduino/libraries/ folder .</i>
</li><li> <i>Rename the unzipped folder "WifiShield"</i>
</li><li> <i>Start the Arduino IDE (or restart if it is open).</i>
</li></ol>
<h3>  Functions </h3>
<p>These are the most important/useful function in the library, we invite you to look at the .h files yourself to see all the functions available.
</p>
<h4>  join() </h4>
<ul type="square">
<li>
<b>Description:</b>
<ul>
<li>Used to join a WiFi access point</li>
</ul>
</li>
<li>
<b>Syntax: </b>
<ul>
<li>join(const char *ssid, const char *phrase, int auth)</li>
</ul>
</li>
<li>
<b>Parameters:</b>
<ul>
<li><b>ssid:</b> The name of the access point you want the shield to connect to</li>
<li><b>phrase:</b> The password/phrase of the access point you want the shield to connect to</li>
<li>
<b>auth:</b> The authentication type of the access point you want the shield to connect to. Can be one of the following constants:
              <ul>
<li>WIFLY_AUTH_OPEN</li>
<li>WIFLY_AUTH_WEP</li>
<li>WIFLY_AUTH_WPA1</li>
<li>WIFLY_AUTH_WPA1_2</li>
<li>WIFLY_AUTH_WPA2_PSK</li>
<li>WIFLY_AUTH_ADHOC</li>
</ul>
</li>
</ul>
</li>
<li>
<b>Returns:</b>
<ul>
<li><b>boolean: </b> true if the connection to the access point was successful, false otherwise.</li>
</ul>
</li>
<li>
<b>Example:</b>
<div class="mw-geshi mw-code mw-content-ltr container" dir="ltr"><div class="arduino source-arduino"><pre class="de1"><span class="co2">#include &lt;SoftwareSerial.h&gt;</span>
<span class="co2">#include "WiFly.h"</span>
 
<span class="kw2">SoftwareSerial</span> uart<span class="br0">(</span><span class="nu0">2</span>, <span class="nu0">3</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// create a serial connection to the WiFi shield TX and RX pins.</span>
WiFly wifly<span class="br0">(</span><span class="sy3">&amp;</span>uart<span class="br0">)</span><span class="sy4">;</span> <span class="co1">// create a WiFly library object using the serial connection to the WiFi shield we created above.</span>
 
<span class="kw4">void</span> <span class="kw2">setup</span><span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
  uart.<span class="kw3">begin</span><span class="br0">(</span><span class="nu0">9600</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// start the serial connection to the shield</span>
  <span class="kw2">Serial</span>.<span class="kw3">begin</span><span class="br0">(</span><span class="nu0">9600</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// start the Arduino serial monitor window connection</span>
  wifly.<span class="me1">reset</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// reset the shield </span>
  <span class="kw1">while</span><span class="br0">(</span>wifly.<span class="me1">join</span><span class="br0">(</span><span class="st0">"mySSID"</span>,<span class="st0">"mySSIDpassword"</span>,WIFLY_AUTH_WPA2_PSK<span class="br0">)</span> <span class="sy1">==</span> <span class="kw2">false</span><span class="br0">)</span>
  <span class="br0">{</span>
    <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Failed to connect to accesspoint. Will try again."</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="br0">}</span>
  <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Connected to access point!"</span><span class="br0">)</span><span class="sy4">;</span>
<span class="br0">}</span>
 
<span class="kw4">void</span> <span class="kw2">loop</span><span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
 
<span class="br0">}</span></pre></div></div>
</li>
</ul>
<h4>  receive() </h4>
<ul>
<li>
<b>Description:</b>
<ul>
<li>Can be used to read data from the shield, an alternative for the Arduino's read() function.</li>
</ul>
</li>
<li>
<b>Syntax: </b>
<ul>
<li>receive(uint8_t *buf, int len, int timeout)</li>
</ul>
</li>
<li>
<b>Parameters:</b>
<ul>
<li><b>buf: </b> A buffer array where the bytes read from the shield is stored.</li>
<li><b>len: </b> The length/size of the buffer array</li>
<li><b>timeout: </b>A timeout value to know when to stop trying to read.</li>
</ul>
</li>
<li>
<b>Returns:</b>
<ul>
<li><b>int: </b> The number of bytes read from the shield.</li>
</ul>
</li>
<li>
<b>Example:</b>
<pre>
  char c;
  while (wifly.receive((uint8_t *)&amp;c, 1, 300) &gt; 0) {
    Serial.print((char)c);
  }
      </pre>
<p>See File-&gt;Examples-&gt;WiFi_Shield-&gt;wifly_test sketch for a complete example. 
</p>
</li>
</ul>
<h4>  sendCommand() </h4>
<ul>
<li>
<b>Description:</b>
<ul>
<li>Some our functions (e.g. join(), reboot(), save()) act as wrappers for the text commands listed in the user manual of the RN171 module. The function sendCommand() allows you to come up with your own wrapper function if ours do not meet your needs. </li>
</ul>
</li>
<li>
<b>Syntax: </b>
<ul>
<li>sendCommand(const char *cmd, const char *ack, int timeout)</li>
</ul>
</li>
<li>
<b>Parameters:</b>
<ul>
<li><b>cmd: </b>Any command from the RN-171's user manual.</li>
<li><b>ack: </b>The expected return string from the command</li>
<li><b>timeout: </b>The time allowed before considering the output a bad  request/response</li>
</ul>
</li>
<li>
<b>Returns:</b>
<ul>
<li><b>boolean: </b> true if the WiFi shield responded with the ack string, false otherwise.</li>
</ul>
</li>
<li>
<b>Example:</b>
<pre>
// our join() function is wrapper for the join command, as seen below. 
//The string "Associated" is what the user manual says the RN171 will return on success.
if(sendCommand("join\r", "Associated",DEFAULT_WAIT_RESPONSE_TIME*10))
{
// joined
}else{
// not able to join
}
      </pre>
<p>See File-&gt;Examples-&gt;WiFi_Shield-&gt;wifly_test sketch for a complete example.
</p>
</li>
</ul>
<h2>  WiFi Shield Examples/Applications </h2>
<h3>  Example 1: Send Commands to WiFi Shield and Receive Response Via The Arduino Serial Monitor Window </h3>
<p>The WiFi shield's RN-171 module is configured by sending it the commands found in <a href="res/WiFly-RN-UM.pdf">its datasheet</a>. You may write a sketch to send the commands automatically, but this is a great example that we recommend you go through because it will teach you exactly how the WiFi shield and RN-171 works.
</p><p>To proceed follow the steps below, we have also created a video if you prefer to watch that
</p><p><a href="https://www.youtube.com/watch?v=8dCrAaN16lE">Video - Getting Started With Seeeduino's WiFi Shield.</a>
</p><p><b>Step 1: WiFi Shield Jumpers Configuration </b>
</p><p>Position the jumpers in the WiFi shield such that digital pin 2 (D2) is selected for WIFI_TX, and digital pin 3 (D3) is selected for WIFI_RX as shown in the photo below. These are the pins we will use to send and receive information from the RN-171.
</p><p><br/>
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:602px;"><img src="img/Wifi_shield_v1.1_front.png" width="600"/> <div class="thumbcaption">Pins D2 for TX, and D3 for RX</div></div></div></div>
<p><b>Step 2: Software/Code</b>
</p><p>In the sketch below we have created a UART object to allow us to send and receive data from the RN-171/WiFi Shield. We then use this object in conjunction with the WiFly library to send data to the shield. The Arduino's Serial object is used to print the data we receive from the shield, and to receive the commands we want to send to the shield via the WiFly/UART object.
</p><p>Upload the following code to your Arduino board:
</p>
<div class="mw-geshi mw-code mw-content-ltr container" dir="ltr"><div class="arduino source-arduino"><pre class="de1">  <span class="co2">#include &lt;Arduino.h&gt;</span>
  <span class="co2">#include &lt;SoftwareSerial.h&gt;</span>
  <span class="co2">#include "WiFly.h"</span>
 
  <span class="co1">// set up a new serial port.</span>
  <span class="kw2">SoftwareSerial</span> uart<span class="br0">(</span><span class="nu0">2</span>, <span class="nu0">3</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// create a serial connection to the WiFi shield TX and RX pins.</span>
  WiFly wifly<span class="br0">(</span><span class="sy3">&amp;</span>uart<span class="br0">)</span><span class="sy4">;</span> <span class="co1">// create a WiFly library object using the serial connection to the WiFi shield we created above.</span>
 
  <span class="kw4">void</span> <span class="kw2">setup</span><span class="br0">(</span><span class="br0">)</span> 
  <span class="br0">{</span>
  uart.<span class="kw3">begin</span><span class="br0">(</span><span class="nu0">9600</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// start the serial connection to the shield</span>
  <span class="kw2">Serial</span>.<span class="kw3">begin</span><span class="br0">(</span><span class="nu0">9600</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// start the Arduino serial monitor window connection</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">3000</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// wait 3 second to allow the serial/uart object to start</span>
  <span class="br0">}</span>
 
  <span class="kw4">void</span> <span class="kw2">loop</span><span class="br0">(</span><span class="br0">)</span> 
  <span class="br0">{</span>
 
  <span class="kw1">while</span> <span class="br0">(</span>wifly.<span class="kw3">available</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>  <span class="co1">// if there is data available from the shield</span>
    <span class="br0">{</span>
    <span class="kw2">Serial</span>.<span class="kw3">write</span><span class="br0">(</span>wifly.<span class="kw3">read</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// display the data in the Serial monitor window.</span>
    <span class="br0">}</span>
 
  <span class="kw1">while</span> <span class="br0">(</span><span class="kw2">Serial</span>.<span class="kw3">available</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> <span class="co1">// if we typed a command</span>
    <span class="br0">{</span>
    wifly.<span class="kw3">write</span><span class="br0">(</span><span class="kw2">Serial</span>.<span class="kw3">read</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// send the command to the WiFi shield.</span>
    <span class="br0">}</span>
  <span class="br0">}</span></pre></div></div>
<p><b>Step 3: Entering Command Mode</b>
</p><p>The WiFly RN-171 module in the WiFi shield can operate in two modes: data, and command. When in data mode, the shield is able to receive and initiate connections. When in command mode, we are able to configure the module using the commands listed in its datasheet.
</p><p>To enter command mode, follow these steps:
</p>
<ol><li> Open the Arduino Serial monitor.
</li><li> Set the serial monitor to “No line ending”, baud rate to 9600.
</li><li> Type "$$$" into the Arduino Serial Monitor and press enter. 
</li><li> The module will respond with the letters “CMD”, indicating that it has entered command mode.
</li></ol>
<p>Let's go ahead and test some commands, do the following: 
</p>
<ol><li> In the Arduino Serial monitor window, select “Carriage return” and a baud rate of 9600.
</li><li> Now type each of the commands in the table below into the Arduino Serial Monitor and press enter. 
</li><li> The module will output a response, as described in the table, for each command.
</li></ol>
<dl><dd><table>
<tr>
<th> Commands </th>
<th> Description
</th></tr>
<tr>
<td> scan </td>
<td> This command performs an active probe scan of access points on all 13 channels. When you use this command, the module returns the MAC address, signal strength, SSID name, and security mode of the access points it finds.
</td></tr>
<tr>
<td> get ip </td>
<td> This command displays the IP address and port number settings
</td></tr></table></dd></dl>
<p><br/>
</p><p>For a complete list of configuration commands, please see the RN-171 <a href="res/WiFly-RN-UM.pdf">Reference Guide</a> starting on page 11.
</p>
<h3>  Example 2: Connect to An Access Point / Internet Router  </h3>
<p>In this example we will show you how to connect the WiFi shield to an access point (your internet router) with and without you typing the commands required:
</p>
<h4>  Connecting By Typing Commands </h4>
<p>This section will teach you how to connect the WiFi shield to an access point using commands from the RN-171 datasheet, by going through this section you will then know exactly what is happening in the background when you use our WiFi Arduino libraries.
</p><p>Do the following:
</p>
<ol><li> Upload the code in Example One to your Arduino board
</li><li> <b>Enter command mode:</b>
<ol><li> Set the serial monitor to “No line ending”, baud rate to 9600.
</li><li> Type <i>$$$</i> into the Arduino Serial Monitor and press enter.
</li></ol>
</li><li> Set the serial monitor to “Carriage return”.
</li><li> <b>Scan for available access points:</b>
<ol><li> Type <i>scan</i> and press enter. The Arduino serial monitor window will output a list of comma separated values for each access point the WiFi shield has found. From left to right the third value is the security mode, the last value is the SSID. This example shows a security mode of 4 with an SSID name MySSID: 01,01,-88,<b>04</b>,1104,1c,00,45:56:78:be:93:1f,<b>MySSID</b>
</li></ol>
</li><li> From the list of access points found, find the one which corresponds to your internet router and note the security mode, and SSID as we will need these two values to connect to it.
</li><li> <b>Set the security mode in the shield: </b>
<ol><li> Type <i>set wlan auth m</i>. Replace <i>m</i> with the security mode number (in this example that would be 4) of the access point you wish to connect to.
</li><li> The security modes supported by the WiFi shield are listed in Figure 1 below. 
</li></ol>
</li><li> <b>Set the access point phrase</b>
<ol><li> Type <i>set wlan phrase myPhrase</i>. Replace <i>myPhrase</i> with your access point's password/security key. <b>Note:</b> if your access point's security type is WEP use <i>key</i> instead of <i>phrase</i> in the command above.
</li><li> The access point's (internet router) phrase is the password you use to connect to it from your PC. In Windows you can find it as shown in the animated image below: <div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:602px;"><img src="img/How_to_find_network_security_key_password.gif" width="600"/> <div class="thumbcaption">How to find a networks' security key/password</div></div></div></div>
</li></ol>
</li><li> <b>Join the access point</b>
<ol><li> Now that we have set the security type and phrase of the access point, we may connect to it.
</li><li> Type <i>join MySSID</i>. Replace MySSID with your access point's broadcast name.
</li><li> The word "Associated!" will be displayed in the Arduino serial monitor window if successful.
</li></ol>
</li></ol>
<p><br/>
</p><p><br/>
A description of the commands you entered in the steps above is available in the table below. A more detailed description of each command can be found in the RN171's user manual.
</p><p><br/>
</p>
<dl><dd><table>
<tr>
<th> Number </th>
<th> Commands </th>
<th> Description
</th></tr>
<tr>
<td> 1 </td>
<td> scan </td>
<td> This command performs an active probe scan of access points on all 13 channels. When you use this command, the module returns the MAC address, signal strength, SSID name, and security mode of the access points it finds.
</td></tr>
<tr>
<td> 2 </td>
<td> set wlan auth 4 </td>
<td> Find the value that corresponds to the security protocol on your access point. Then, tell the WiFly what security protocol to use, it is the number shown in <b>Fijure 1</b> that corresponds to the access point's security protocol. Here we choose “4”.
</td></tr>
<tr>
<td> 3 </td>
<td> set wlan phrase seeed-mkt </td>
<td> Tell the WiFi shield your passphrase.
</td></tr>
<tr>
<td> 4 </td>
<td> join SEEED-MKT </td>
<td>  Tell the WiFi shield to join, “SEEED-MKT“ is the name of the access point we choose to connect. After sending the command the module should now connect and print out information about the connection. (If the connection is failed, try to send the command again until it works )
</td></tr></table></dd></dl>
<p><br/>
</p>
<dl><dd><table>
<caption> Figure 1
</caption>
<tr>
<th> Value </th>
<th> Authentication Mode
</th></tr>
<tr>
<td> 0 </td>
<td> Open (Default)
</td></tr>
<tr>
<td> 1 </td>
<td> WEP-128
</td></tr>
<tr>
<td> 2 </td>
<td> WPA1
</td></tr>
<tr>
<td> 3 </td>
<td> Mixed WPA1 and WPA2-PSK
</td></tr>
<tr>
<td> 4 </td>
<td> WPA2-PSK
</td></tr>
<tr>
<td> 5 </td>
<td> Not used
</td></tr>
<tr>
<td> 6 </td>
<td> AD hoc mode (join any ad hoc network)
</td></tr>
<tr>
<td> 8 </td>
<td> WPE-64
</td></tr></table></dd></dl>
<h4>  Connecting Using Our WiFi Libraries </h4>
<p>Now that you know how to connect to an access point by typing each command it's time to use the libraries and examples we provide.
</p><p>To see code required to connect to an access point go to “File -&gt; Examples -&gt; Wifi_Shield -&gt; wifi_test”.
Change the code to use your own SSID (access point name), and KEY (your access point's password), then upload the sketch to your Arduino IDE.
</p>
<pre>
  #define SSID      " SEEED-MKT "
  #define KEY       " seeed-mkt "
</pre>
<p>With the sketch uploaded to your Arduino board, open the serial monitor window. If the shield was successful in joining the access point an "OK" message will be displayed along with the connection information resulting from the "get everything" command.  If the shield failed to join the access point a "Failed" message will be displayed.
</p><p><br/>
</p>
<h4>  Configuring The Shield to Connect On Power-Up </h4>
<p>The shield can be configured to connect on power up, you only have to do this once:
</p>
<ol><li> Send the "set wlan ssid mySSID" command replacing mySSID with your SSID
</li><li> Send the "set wlan join 1" command.
</li><li> Send the "save" command.
</li></ol>
<p>Now the shield will connect to the access point automatically on power up.
</p><p>A description of what each command does can be found in the RN-171 datasheet and in the table below.
</p>
<dl><dd><table>
<tr>
<th> Number </th>
<th> Commands </th>
<th> Description
</th></tr>
<tr>
<td> 1 </td>
<td> set wlan ssid &lt;ssid&gt; </td>
<td> "&lt;ssid&gt;" is the name of the access point you'd like to connect to automatically
</td></tr>
<tr>
<td> 2 </td>
<td> set wlan join 1 </td>
<td> This tells the module to try and connect to the SSID stored in memory automatically.
</td></tr>
<tr>
<td> 3 </td>
<td> save </td>
<td> Store/Save these settings in the Wifi's config file
</td></tr></table></dd></dl>
<p><br/>
</p>
<h4>  Setting a Static IP Address </h4>
<p>To have the shield obtain a static IP address from the access point, once connected to the access point, send the following commands:
</p>
<dl><dd><table>
<tr>
<th> Number </th>
<th> Commands </th>
<th> Description
</th></tr>
<tr>
<td> 1 </td>
<td> set ip dhcp 0 </td>
<td> Turn of DHCP .
</td></tr>
<tr>
<td> 2 </td>
<td> set ip address &lt;address&gt; </td>
<td> Set the IP address you want .
</td></tr></table></dd></dl>
<p><br/>
</p>
<h3>  Example 3: Communicating With the Network (Introduction) </h3>
<p>This example will show you how a device such as your PC and/or phone may talk to the WiFi shield.
</p><p>Follow these steps:
</p>
<ol><li> Configure the module with step1-7 in Example 2's section <i>Connecting By Typing Commands</i>
</li><li> Set the listening IP port to "80" by sending the commands "set ip local 80"
</li><li> Connect/Join your shield to an access point as shown in the step 8 in Example 2's section <i>Connecting By Typing Commands</i>
</li><li> Save these setting by sending the "save" command
</li><li> Get the IP address of your shield with the command "get ip". The IP address and port will be displayed to the right of "IP=" in the response (e.g. IP=192.168.0.10:80)
</li><li> Open your web browser and type your shield's IP address in your web browser's URL bar and press Enter to visit it.
</li><li> Your Arduino's serial monitor window will display an HTTP response similar to the one below. This is the information that your browser sent to the shield to request data.
</li></ol>
<pre>
*OPEN*GET / HTTP/1.1
Host: 192.168.0.10
Connection: keep-alive
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36
Accept-Encoding: gzip, deflate, sdch
Accept-Language: en-US,en;q=0.8
</pre>
<p><br/>
<br/>
The browser is now waiting for data, the Wifi module can send sensor values, serve web pages, or any other data straight back to the browser! In this case, the browser is waiting for a web page. If the Wifi module responds with an HTML-formatted page, the browser will display it. The next examples will teach you how to do all this fun stuff.
<br/>
</p>
<h3>  Example 4: Using the WiFi Shield as Webserver (Serving Webpages From the Shield) </h3>
<p>As you saw in Example 3, an internet/web browser is able to connect to the WiFi shield. Once a connection has been established (when the browser sends its HTTP request), the WiFi shield may then send back HTML code for the browser to display as a webpage. In this example you will learn what is needed for the shield to reply to a web browser.
</p><p><b> Step One: Arduino Code</b>
</p><p>Upload the following code to your Arduino board replacing "myssid" and "mypassword" with your accesspoint's values respectively:
</p>
<div class="mw-geshi mw-code mw-content-ltr container" dir="ltr"><div class="arduino source-arduino"><pre class="de1"><span class="co2">#include &lt;SoftwareSerial.h&gt;</span>
<span class="co2">#include "WiFly.h"</span>
 
<span class="co2">#define SSID      "myssid"</span>
<span class="co2">#define KEY       "mypassword"</span>
<span class="co1">// check your access point's security mode, mine was WPA20-PSK</span>
<span class="co1">// if yours is different you'll need to change the AUTH constant, see the file WiFly.h for avalable security codes</span>
<span class="co2">#define AUTH      WIFLY_AUTH_WPA2_PSK</span>
 
<span class="kw4">int</span> flag <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span>
 
<span class="co1">// Pins' connection</span>
<span class="co1">// Arduino       WiFly</span>
<span class="co1">//  2    &lt;----&gt;    TX</span>
<span class="co1">//  3    &lt;----&gt;    RX</span>
 
<span class="kw2">SoftwareSerial</span> wiflyUart<span class="br0">(</span><span class="nu0">2</span>, <span class="nu0">3</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// create a WiFi shield serial object</span>
WiFly wifly<span class="br0">(</span><span class="sy3">&amp;</span>wiflyUart<span class="br0">)</span><span class="sy4">;</span> <span class="co1">// pass the wifi siheld serial object to the WiFly class</span>
 
<span class="kw4">void</span> <span class="kw2">setup</span><span class="br0">(</span><span class="br0">)</span> 
<span class="br0">{</span>
  wiflyUart.<span class="kw3">begin</span><span class="br0">(</span><span class="nu0">9600</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// start wifi shield uart port</span>
 
  <span class="kw2">Serial</span>.<span class="kw3">begin</span><span class="br0">(</span><span class="nu0">9600</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// start the arduino serial port</span>
  <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"--------- WIFLY Webserver --------"</span><span class="br0">)</span><span class="sy4">;</span>
 
  <span class="co1">// wait for initilization of wifly</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">1000</span><span class="br0">)</span><span class="sy4">;</span>
 
  wifly.<span class="me1">reset</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// reset the shield </span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">1000</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="co1">//set WiFly params</span>
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"set ip local 80<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// set the local comm port to 80</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">100</span><span class="br0">)</span><span class="sy4">;</span>
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"set comm remote 0<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// do not send a default string when a connection opens</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">100</span><span class="br0">)</span><span class="sy4">;</span>
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"set comm open *OPEN*<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// set the string that the wifi shield will output when a connection is opened</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">100</span><span class="br0">)</span><span class="sy4">;</span>
 
  <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Join "</span> SSID <span class="br0">)</span><span class="sy4">;</span>
  <span class="kw1">if</span> <span class="br0">(</span>wifly.<span class="me1">join</span><span class="br0">(</span>SSID, KEY, AUTH<span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"OK"</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span>
    <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Failed"</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="br0">}</span>
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"get ip<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="kw4">char</span> c<span class="sy4">;</span>
 
  <span class="kw1">while</span> <span class="br0">(</span>wifly.<span class="kw3">receive</span><span class="br0">(</span><span class="br0">(</span>uint8_t <span class="sy2">*</span><span class="br0">)</span><span class="sy3">&amp;</span>c, <span class="nu0">1</span>, <span class="nu0">300</span><span class="br0">)</span> <span class="sy1">&gt;</span> <span class="nu0">0</span><span class="br0">)</span> <span class="br0">{</span> <span class="co1">// print the response from the get ip command</span>
    <span class="kw2">Serial</span>.<span class="kw3">print</span><span class="br0">(</span><span class="br0">(</span><span class="kw4">char</span><span class="br0">)</span>c<span class="br0">)</span><span class="sy4">;</span>
  <span class="br0">}</span>
 
  <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Web server ready"</span><span class="br0">)</span><span class="sy4">;</span>
 
<span class="br0">}</span>
 
<span class="kw4">void</span> <span class="kw2">loop</span><span class="br0">(</span><span class="br0">)</span> 
<span class="br0">{</span>
 
  <span class="kw1">if</span><span class="br0">(</span>wifly.<span class="kw3">available</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> 
  <span class="br0">{</span> <span class="co1">// the wifi shield has data available</span>
 
    <span class="kw1">if</span><span class="br0">(</span>wiflyUart.<span class="me1">find</span><span class="br0">(</span><span class="st0">"*OPEN*"</span><span class="br0">)</span><span class="br0">)</span> <span class="co1">// see if the data available is from an open connection by looking for the *OPEN* string</span>
    <span class="br0">{</span>
      <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"New Browser Request!"</span><span class="br0">)</span><span class="sy4">;</span>
      <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">1000</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// delay enough time for the browser to complete sending its HTTP request string</span>
 
      <span class="co1">// send HTTP header</span>
      wiflyUart.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"HTTP/1.1 200 OK"</span><span class="br0">)</span><span class="sy4">;</span>
      wiflyUart.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Content-Type: text/html; charset=UTF-8"</span><span class="br0">)</span><span class="sy4">;</span>
      wiflyUart.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Content-Length: 244"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// length of HTML code</span>
      wiflyUart.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Connection: close"</span><span class="br0">)</span><span class="sy4">;</span>
      wiflyUart.<span class="kw3">println</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
 
      <span class="co1">// send webpage's HTML code</span>
      wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;html&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
      wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;head&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
      wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;title&gt;My WiFI Shield Webpage&lt;/title&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
      wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;/head&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
      wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;body&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
      wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;h1&gt;Hello World!&lt;/h1&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
      wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;h3&gt;This website is served from my WiFi module&lt;/h3&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
      wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;a href=<span class="es1">\"</span>http://yahoo.com<span class="es1">\"</span>&gt;Yahoo!&lt;/a&gt; &lt;a href=<span class="es1">\"</span>http://google.com<span class="es1">\"</span>&gt;Google&lt;/a&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
      wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;br/&gt;&lt;button&gt;My Button&lt;/button&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
      wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;/body&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
      wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;/html&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
 
    <span class="br0">}</span>
  <span class="br0">}</span>
 
<span class="br0">}</span></pre></div></div>
<p><b> Step Two: Get the Shield's IP Address </b>
</p><p>Open the serial monitor window and wait for the "Web server ready" message to display. The serial monitor will also display the WiFi shield's IP address:
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:417px;"><img src="img/Wifi-shield-led-control-serial-comm-window.png" width="415"/> <div class="thumbcaption">Arduino program serial comm output. The IP address of the shield is highlighted.</div></div></div></div>
<p><b> Step Three: Visiting the webpage </b>
</p><p>Now visit that IP address in your web browser. The webpage below should be displayed, it contains a link to Yahoo! and Google and a button that doesn't do anything (yet):
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:415px;"><img src="img/Wifi-shield-simple-webserver-page.png" width="413"/> <div class="thumbcaption">A simple webpage with two links and one button served from the WiFi shield.</div></div></div></div>
<p>When the webpage is visited the serial monitor window will also display a "New Browser Request!" string as shown below:
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:366px;"><img src="img/Wifi-shield-simple-webserver-arduino-serial-window-response.png" width="364"/> <div class="thumbcaption">The Arduino serial comm window showing that it detected a new browser connection/request.</div></div></div></div>
<p><br/>
<b>Note:</b> In the case of some browsers, like Google Chrome, even typing the URL in the bar sends a webpage request, this is because these browsers try to get the webpage's title for the user's convenience even before he/she visits the webpage.
</p>
<h3>  Example 5: Controlling The Arduino Digital Pins From a Webpage (Toggling LEDs From an Webpage) </h3>
<p>In this example we will create a webpage with three buttons to control three different digital pins in the Arduino.
</p><p>For this tutorial follow the steps below. We have also created a video where we explain the code in more detail.
</p><p><a href="https://www.youtube.com/watch?v=ek63patAl80">Video - WiFi Shield Arduino Digital Pin Control From Webpage</a>
</p><p><b>Step 1: Hardware</b>
</p><p>Connect three LEDs and resistor to digital pins 11, 12, and 13 as shown in the schematic below:
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:602px;"><img src="img/Wifi-shield-led-control-schematic.png" width="600"/> <div class="thumbcaption">Three LEDs and 1k resistors connected to pins 11, 12, and 13.</div></div></div></div>
<p><b>Step 2: Arduino Sketch</b>
</p><p>Upload the following code to your Arduino board but replace "mySSID" and "myPassword" with your access point's SSID name and password:
</p>
<div class="mw-geshi mw-code mw-content-ltr container" dir="ltr"><div class="arduino source-arduino"><pre class="de1"><span class="co2">#include &lt;SoftwareSerial.h&gt;</span>
<span class="co2">#include "WiFly.h"</span>
 
<span class="co2">#define SSID      "mySSID"</span>
<span class="co2">#define KEY       "myPassword"</span>
<span class="co1">// check your access point's security mode, mine was WPA20-PSK</span>
<span class="co1">// if yours is different you'll need to change the AUTH constant, see the file WiFly.h for avalable security codes</span>
<span class="co2">#define AUTH      WIFLY_AUTH_WPA2_PSK</span>
 
<span class="kw4">int</span> flag <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span>
 
<span class="co1">// Pins' connection</span>
<span class="co1">// Arduino       WiFly</span>
<span class="co1">//  2    &lt;----&gt;    TX</span>
<span class="co1">//  3    &lt;----&gt;    RX</span>
 
<span class="kw2">SoftwareSerial</span> wiflyUart<span class="br0">(</span><span class="nu0">2</span>, <span class="nu0">3</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// create a WiFi shield serial object</span>
WiFly wifly<span class="br0">(</span><span class="sy3">&amp;</span>wiflyUart<span class="br0">)</span><span class="sy4">;</span> <span class="co1">// pass the wifi siheld serial object to the WiFly class</span>
<span class="kw4">char</span> ip<span class="br0">[</span><span class="nu0">16</span><span class="br0">]</span><span class="sy4">;</span>
 
<span class="kw4">void</span> <span class="kw2">setup</span><span class="br0">(</span><span class="br0">)</span> 
<span class="br0">{</span>
  <span class="kw3">pinMode</span><span class="br0">(</span><span class="nu0">11</span>,<span class="kw2">OUTPUT</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="kw3">digitalWrite</span><span class="br0">(</span><span class="nu0">11</span>,<span class="kw2">LOW</span><span class="br0">)</span><span class="sy4">;</span>
 
  <span class="kw3">pinMode</span><span class="br0">(</span><span class="nu0">12</span>,<span class="kw2">OUTPUT</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="kw3">digitalWrite</span><span class="br0">(</span><span class="nu0">12</span>,<span class="kw2">LOW</span><span class="br0">)</span><span class="sy4">;</span>
 
  <span class="kw3">pinMode</span><span class="br0">(</span><span class="nu0">13</span>,<span class="kw2">OUTPUT</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="kw3">digitalWrite</span><span class="br0">(</span><span class="nu0">13</span>,<span class="kw2">LOW</span><span class="br0">)</span><span class="sy4">;</span>
 
  wiflyUart.<span class="kw3">begin</span><span class="br0">(</span><span class="nu0">9600</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// start wifi shield uart port</span>
 
  <span class="kw2">Serial</span>.<span class="kw3">begin</span><span class="br0">(</span><span class="nu0">9600</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// start the arduino serial port</span>
  <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"--------- WIFLY Webserver --------"</span><span class="br0">)</span><span class="sy4">;</span>
 
  <span class="co1">// wait for initilization of wifly</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">1000</span><span class="br0">)</span><span class="sy4">;</span>
 
  wifly.<span class="me1">reset</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// reset the shield </span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">1000</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="co1">//set WiFly params</span>
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"set ip local 80<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// set the local comm port to 80</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">100</span><span class="br0">)</span><span class="sy4">;</span>
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"set comm remote 0<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// do not send a default string when a connection opens</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">100</span><span class="br0">)</span><span class="sy4">;</span>
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"set comm open *OPEN*<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// set the string that the wifi shield will output when a connection is opened</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">100</span><span class="br0">)</span><span class="sy4">;</span>
 
  <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Join "</span> SSID <span class="br0">)</span><span class="sy4">;</span>
  <span class="kw1">if</span> <span class="br0">(</span>wifly.<span class="me1">join</span><span class="br0">(</span>SSID, KEY, AUTH<span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"OK"</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span>
    <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Failed"</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="br0">}</span>
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"get ip<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span>
 
 
  wiflyUart.<span class="me1">setTimeout</span><span class="br0">(</span><span class="nu0">500</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="kw1">if</span><span class="br0">(</span><span class="sy3">!</span>wiflyUart.<span class="me1">find</span><span class="br0">(</span><span class="st0">"IP="</span><span class="br0">)</span><span class="br0">)</span>
  <span class="br0">{</span>
    <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"can not get ip"</span><span class="br0">)</span><span class="sy4">;</span>
    <span class="kw1">while</span><span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span><span class="sy4">;;</span>
  <span class="br0">}</span><span class="kw1">else</span>
  <span class="br0">{</span>
    <span class="kw2">Serial</span>.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"IP:"</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="br0">}</span>
 
  <span class="kw4">char</span> c<span class="sy4">;</span>
  <span class="kw4">int</span> index <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span>
  <span class="kw1">while</span> <span class="br0">(</span>wifly.<span class="kw3">receive</span><span class="br0">(</span><span class="br0">(</span>uint8_t <span class="sy2">*</span><span class="br0">)</span><span class="sy3">&amp;</span>c, <span class="nu0">1</span>, <span class="nu0">300</span><span class="br0">)</span> <span class="sy1">&gt;</span> <span class="nu0">0</span><span class="br0">)</span> <span class="br0">{</span> <span class="co1">// print the response from the get ip command</span>
    <span class="kw1">if</span><span class="br0">(</span>c <span class="sy1">==</span> <span class="st0">':'</span><span class="br0">)</span>
    <span class="br0">{</span>
      ip<span class="br0">[</span>index<span class="br0">]</span> <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span> 
      <span class="kw1">break</span><span class="sy4">;</span>
    <span class="br0">}</span>
    ip<span class="br0">[</span>index<span class="sy2">++</span><span class="br0">]</span> <span class="sy1">=</span> c<span class="sy4">;</span>
    <span class="kw2">Serial</span>.<span class="kw3">print</span><span class="br0">(</span><span class="br0">(</span><span class="kw4">char</span><span class="br0">)</span>c<span class="br0">)</span><span class="sy4">;</span>
 
  <span class="br0">}</span>
  <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="kw1">while</span> <span class="br0">(</span>wifly.<span class="kw3">receive</span><span class="br0">(</span><span class="br0">(</span>uint8_t <span class="sy2">*</span><span class="br0">)</span><span class="sy3">&amp;</span>c, <span class="nu0">1</span>, <span class="nu0">300</span><span class="br0">)</span> <span class="sy1">&gt;</span> <span class="nu0">0</span><span class="br0">)</span><span class="sy4">;;</span>
 
  <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Web server ready"</span><span class="br0">)</span><span class="sy4">;</span>
 
<span class="br0">}</span>
 
<span class="kw4">void</span> <span class="kw2">loop</span><span class="br0">(</span><span class="br0">)</span> 
<span class="br0">{</span>
 
  <span class="kw1">if</span><span class="br0">(</span>wifly.<span class="kw3">available</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> 
  <span class="br0">{</span> <span class="co1">// the wifi shield has data available</span>
 
    <span class="kw1">if</span><span class="br0">(</span>wiflyUart.<span class="me1">find</span><span class="br0">(</span><span class="st0">"*OPEN*"</span><span class="br0">)</span><span class="br0">)</span> <span class="co1">// see if the data available is from an open connection by looking for the *OPEN* string</span>
    <span class="br0">{</span>
      <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"New Browser Request!"</span><span class="br0">)</span><span class="sy4">;</span>
      <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">1000</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// delay enough time for the browser to complete sending its HTTP request string</span>
 
      <span class="kw1">if</span><span class="br0">(</span>wiflyUart.<span class="me1">find</span><span class="br0">(</span><span class="st0">"pin="</span><span class="br0">)</span><span class="br0">)</span> <span class="co1">// look for the string "pin=" in the http request, if it's there then we want to control the LED</span>
      <span class="br0">{</span>
        <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"LED Control"</span><span class="br0">)</span><span class="sy4">;</span>
 
        <span class="co1">// the user wants to toggle the LEDs</span>
        <span class="kw4">int</span> pinNumber <span class="sy1">=</span> <span class="br0">(</span>wiflyUart.<span class="kw3">read</span><span class="br0">(</span><span class="br0">)</span><span class="sy2">-</span><span class="nu0">48</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// get first number i.e. if the pin 13 then the 1st number is 1</span>
        <span class="kw4">int</span> secondNumber <span class="sy1">=</span> <span class="br0">(</span>wiflyUart.<span class="kw3">read</span><span class="br0">(</span><span class="br0">)</span><span class="sy2">-</span><span class="nu0">48</span><span class="br0">)</span><span class="sy4">;</span>
        <span class="kw1">if</span><span class="br0">(</span>secondNumber<span class="sy1">&gt;=</span><span class="nu0">0</span> <span class="sy3">&amp;&amp;</span> secondNumber<span class="sy1">&lt;=</span><span class="nu0">9</span><span class="br0">)</span>
        <span class="br0">{</span>
          pinNumber<span class="sy2">*</span><span class="sy1">=</span><span class="nu0">10</span><span class="sy4">;</span>
          pinNumber <span class="sy2">+</span><span class="sy1">=</span>secondNumber<span class="sy4">;</span> <span class="co1">// get second number, i.e. if the pin number is 13 then the 2nd number is 3, then add to the first number</span>
        <span class="br0">}</span>
 
        <span class="kw3">digitalWrite</span><span class="br0">(</span>pinNumber, <span class="sy3">!</span><span class="kw3">digitalRead</span><span class="br0">(</span>pinNumber<span class="br0">)</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// toggle pin </span>
 
        <span class="co1">// Build pinstate string. The Arduino replies to the browser with this string.</span>
        String pinState <span class="sy1">=</span> <span class="st0">"Pin "</span><span class="sy4">;</span>
        pinState<span class="sy2">+</span><span class="sy1">=</span>pinNumber<span class="sy4">;</span>
        pinState<span class="sy2">+</span><span class="sy1">=</span><span class="st0">" is "</span><span class="sy4">;</span>
        <span class="kw1">if</span><span class="br0">(</span><span class="kw3">digitalRead</span><span class="br0">(</span>pinNumber<span class="br0">)</span><span class="br0">)</span> <span class="co1">// check if the pin is ON or OFF</span>
        <span class="br0">{</span>
          pinState<span class="sy2">+</span><span class="sy1">=</span><span class="st0">"ON"</span><span class="sy4">;</span> <span class="co1">// the pin is on</span>
        <span class="br0">}</span>
        <span class="kw1">else</span>
        <span class="br0">{</span>
         pinState<span class="sy2">+</span><span class="sy1">=</span><span class="st0">"OFF"</span><span class="sy4">;</span>  <span class="co1">// the pin is off</span>
        <span class="br0">}</span>
        <span class="co1">// build HTTP header Content-Length string.</span>
        String contentLength<span class="sy1">=</span><span class="st0">"Content-Length: "</span><span class="sy4">;</span>
        contentLength<span class="sy2">+</span><span class="sy1">=</span>pinState.<span class="me1">length</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// the value of the length is the lenght of the string the Arduino is replying to the browser with.</span>
 
        <span class="co1">// send HTTP header</span>
        wiflyUart.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"HTTP/1.1 200 OK"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Content-Type: text/html; charset=UTF-8"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">println</span><span class="br0">(</span>contentLength<span class="br0">)</span><span class="sy4">;</span> <span class="co1">// length of HTML code</span>
        wiflyUart.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Connection: close"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">println</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
        <span class="co1">// send response</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span>pinState<span class="br0">)</span><span class="sy4">;</span>
      <span class="br0">}</span>
      <span class="kw1">else</span>
      <span class="br0">{</span>
        <span class="co1">// send HTTP header</span>
        wiflyUart.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"HTTP/1.1 200 OK"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Content-Type: text/html; charset=UTF-8"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Content-Length: 540"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// length of HTML code</span>
        wiflyUart.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Connection: close"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">println</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
 
        <span class="co1">// send webpage's HTML code</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;html&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;head&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;title&gt;WiFi Shield Webpage&lt;/title&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;/head&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;body&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;h1&gt;LED Toggle Webpage&lt;/h1&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
  	  <span class="co1">// In the &lt;button&gt; tags, the ID attribute is the value sent to the arduino via the "pin" GET parameter</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;button id=<span class="es1">\"</span>11<span class="es1">\"</span> class=<span class="es1">\"</span>led<span class="es1">\"</span>&gt;Toggle Pin 11&lt;/button&gt; "</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// button for pin 11</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;button id=<span class="es1">\"</span>12<span class="es1">\"</span> class=<span class="es1">\"</span>led<span class="es1">\"</span>&gt;Toggle Pin 12&lt;/button&gt; "</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// button for pin 12</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;button id=<span class="es1">\"</span>13<span class="es1">\"</span> class=<span class="es1">\"</span>led<span class="es1">\"</span>&gt;Toggle Pin 13&lt;/button&gt; "</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// button for pin 13</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;script src=<span class="es1">\"</span>http://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js<span class="es1">\"</span>&gt;&lt;/script&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;script type=<span class="es1">\"</span>text/javascript<span class="es1">\"</span>&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"$(document).ready(function(){"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"$(<span class="es1">\"</span>.led<span class="es1">\"</span>).click(function(){"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"var p = $(this).attr('id');"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// get id value (i.e. pin13, pin12, or pin11)</span>
        <span class="co1">// send HTTP GET request to the IP address with the parameter "pin" and value "p", then execute the function</span>
  	<span class="co1">// IMPORTANT: dont' forget to replace the IP address and port with YOUR shield's IP address and port</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"$.get(<span class="es1">\"</span>http://"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span>ip<span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">":80/a<span class="es1">\"</span>, {pin:p},function(data){alert(data)});"</span><span class="br0">)</span><span class="sy4">;</span><span class="co1">// execute get request. Upon return execute the "function" (display an alert with the "data" send back to the browser.</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"});"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"});"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;/script&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;/body&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"&lt;/html&gt;"</span><span class="br0">)</span><span class="sy4">;</span>
      <span class="br0">}</span>
      <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Data sent to browser"</span><span class="br0">)</span><span class="sy4">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
 
<span class="br0">}</span></pre></div></div>
<p><b>Step 3: Serial Monitor Window</b>
</p><p>Open the serial monitor window and wait for the "Web server ready" message to display. The serial monitor will also display the WiFi shield's IP address:
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:417px;"><img src="img/Wifi-shield-led-control-serial-comm-window.png" width="415"/> <div class="thumbcaption">Arduino program serial comm output. The IP address of the shield is highlighted.</div></div></div></div>
<p><br/>
<b>Step 4: Visit The Webpage</b>
</p><p>Visit the IP address in a web browser. A webpage with three buttons, like the one below, should display. Click on the buttons to control the LEDs.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:426px;"><img src="img/Wifi-shield-led-control-webpage.png" width="424"/> <div class="thumbcaption">LED control webpage served from the WiFi shield.</div></div></div></div>
<p>The Arduino will also respond back to the web browser with the pin's state, the browser will display this in an alert window.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:369px;"><img src="img/Wifi-shield-led-control-arduino-response.png" width="367"/> <div class="thumbcaption">Alert dialog displaying the state of Pin12, The string Pin12 is ON was sent from the Arduino.</div></div></div></div>
<p>The serial monitor window will also show when a browser sends a request to either visit the webpage or control the LED pins.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:417px;"><img src="img/Wifi-shield-led-control-serial-comm-response.png" width="415"/> <div class="thumbcaption">Arduino serial comm output when an HTTP request is sent to the shield.</div></div></div></div>
<h3>  Example 6: WiFi Shield and Android App </h3>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:602px;"><img src="img/Androidapp-ethernet-shield-led-toggle.png" width="600"/> <div class="thumbcaption">The Android app you can use to control the Arduino's pins through the WiFi or Ethernet Shield.</div></div></div></div>
<p><b> Android Application </b>
</p><p>We've created an Android app that can toggle the digital pins in the Arduino through the WiFi shield, to see how the app works and learn about the code watch the video in this link:
</p><p><a href="https://www.youtube.com/watch?v=0R709uGvkWM">Video - WiFi Shield Android App for Arduino Pin Control</a>
</p><p><b> Software </b>
</p><p>Download the Android Studio project/source form this link:
</p><p><a href="res/WiFiShieldLEDControl.zip" title="File:WiFiShieldLEDControl.zip">File:WiFiShieldLEDControl.zip</a>
</p>
<h3>  Example 7: Sending Data To and Retrieving Data From an External Server </h3>
<p>The RN-171 module in the WiFi shield has the ability to act as an HTML client (a text based web browser essentially), this means that we can use the shield to send and receive data from a web server. In this example you will learn to use the shield with a web Application Programming Interface (API) that displays any city's weather data (i.e. temperature, humidity, etc). 
</p><p>The name of the API we'll use is <a href="http://openweathermap.org/api">OpenWeatherMap</a>, when you send the name of a city and country to this website it returns a JSON string with weather information. If you want to display the weather for London UK for example you would visit the following URL <a href="http://api.openweathermap.org/data/2.5/weather?q=London,uk">http://api.openweathermap.org/data/2.5/weather?q=London,uk</a> which would return a JSON string like the following, where the weather data and other information is embedded.
</p>
<pre>
{
"coord":{"lon":-0.13,"lat":51.51},
"sys":{"type":3,"id":60992,"message":0.0079,"country":"GB","sunrise":1421395087,"sunset":1421425352},
"weather":[{"id":802,"main":"Clouds","description":"scattered clouds","icon":"03n"}],
"base":"cmc stations",
"main":{
  "temp":277.25,"humidity":79,"pressure":998.4,
  "temp_min":277.25,"temp_max":277.25
},
"wind":{
"speed":2,"gust":5,"deg":180},
"rain":{"3h":0},"clouds":{"all":32},
"dt":1421372140,"id":2643743,"name":"London","cod":200
}
</pre>
<p><br/>
<b> Step 1: The URL</b>
</p><p>Let us go ahead and retrieve the weather JSON string for San Francisco, US. The URL our WiFi shield needs to visit is the following (you may test it in your web browser):
</p>
<pre>
http://api.openweathermap.org/data/2.5/weather?q=San%20Francisco,US
</pre>
<p><b> Step 2: The Arduino Code </b>
</p><p>Section 13 of the <a href="res/WiFly-RN-UM.pdf">WiFly manual</a> teaches you different ways to connect to a web server, but in all cases we need to specify the name of the server (or IP address if the server does not have a domain name), and then the data we wish to send.
</p><p>The commands we need to send to the WiFi shield to receive the JSON string from the OpenWeatherMap server are the following:
</p>
<pre>
set ip proto 18 //enable html client
set dns name api.openweathermap.org //name of your webserver
set ip address 0 // so WiFly will use DNS
set ip remote 80 // standard webserver port
set com remote 0 // turn off the REMOTE string so it does not interfere with the post 
open // to open the connection
GET /data/2.5/weather?q=San%20Francisco,US \n\n // to send the data
</pre>
<p><br/>
This is the arduino code that will send the commands:
</p>
<div class="mw-geshi mw-code mw-content-ltr container" dir="ltr"><div class="arduino source-arduino"><pre class="de1"><span class="co2">#include &lt;SoftwareSerial.h&gt;</span>
<span class="co2">#include "WiFly.h"</span>
 
<span class="co2">#define SSID      "mySSID"</span>
<span class="co2">#define KEY       "myPassword"</span>
<span class="co1">// check your access point's security mode, mine was WPA20-PSK</span>
<span class="co1">// if yours is different you'll need to change the AUTH constant, see the file WiFly.h for avalable security codes</span>
<span class="co2">#define AUTH      WIFLY_AUTH_WPA2_PSK</span>
 
<span class="co1">// Pins' connection</span>
<span class="co1">// Arduino       WiFly</span>
<span class="co1">//  2    &lt;----&gt;    TX</span>
<span class="co1">//  3    &lt;----&gt;    RX</span>
 
<span class="kw2">SoftwareSerial</span> wiflyUart<span class="br0">(</span><span class="nu0">2</span>, <span class="nu0">3</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// create a WiFi shield serial object</span>
WiFly wifly<span class="br0">(</span><span class="sy3">&amp;</span>wiflyUart<span class="br0">)</span><span class="sy4">;</span> <span class="co1">// pass the wifi siheld serial object to the WiFly class</span>
 
<span class="kw4">void</span> <span class="kw2">setup</span><span class="br0">(</span><span class="br0">)</span> 
<span class="br0">{</span>
 
 
 
  wiflyUart.<span class="kw3">begin</span><span class="br0">(</span><span class="nu0">9600</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// start wifi shield uart port</span>
 
  <span class="kw2">Serial</span>.<span class="kw3">begin</span><span class="br0">(</span><span class="nu0">9600</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// start the arduino serial port</span>
  <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"--------- OpenWeatherMap API --------"</span><span class="br0">)</span><span class="sy4">;</span>
 
  <span class="co1">// wait for initilization of wifly</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">3000</span><span class="br0">)</span><span class="sy4">;</span>
 
  wifly.<span class="me1">reset</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// reset the shield </span>
 
  <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Join "</span> SSID <span class="br0">)</span><span class="sy4">;</span>
  <span class="kw1">if</span> <span class="br0">(</span>wifly.<span class="me1">join</span><span class="br0">(</span>SSID, KEY, AUTH<span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"OK"</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span>
    <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Failed"</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="br0">}</span>
 
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"set ip proto 18<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">//enable html client</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">100</span><span class="br0">)</span><span class="sy4">;</span>
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"set dns name api.openweathermap.org<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// name of the webserver we want to connect to</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">100</span><span class="br0">)</span><span class="sy4">;</span>
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"set ip address 0<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// so WiFly will use DNS</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">100</span><span class="br0">)</span><span class="sy4">;</span>
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"set ip remote 80<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">/// standard webserver port</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">100</span><span class="br0">)</span><span class="sy4">;</span>
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"set com remote 0<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// turn off the REMOTE string so it does not interfere with the post </span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">100</span><span class="br0">)</span><span class="sy4">;</span>  
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"open<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// open connection</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">100</span><span class="br0">)</span><span class="sy4">;</span>  
 
  wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"GET /data/2.5/weather?q=San%20Francisco,US <span class="es1">\n</span><span class="es1">\n</span>"</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">1000</span><span class="br0">)</span><span class="sy4">;</span>
 
<span class="br0">}</span>
 
<span class="kw4">void</span> <span class="kw2">loop</span><span class="br0">(</span><span class="br0">)</span> 
<span class="br0">{</span>
 <span class="co1">//As soon as the data  received from the Internet ,output the data through the UART Port .</span>
 <span class="kw1">while</span> <span class="br0">(</span>wifly.<span class="kw3">available</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> 
   <span class="br0">{</span>
   <span class="kw2">Serial</span>.<span class="kw3">write</span><span class="br0">(</span>wifly.<span class="kw3">read</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy4">;</span>
   <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p><b> Step 3: Result </b>
</p><p>Open the serial monitor window, you should be able to see the same JSON string you saw in the browser.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:576px;"><img src="img/Open-weather-api-json-string.png" width="574"/> <div class="thumbcaption">JSON weather string shown in the Arduino serial monitor window.</div></div></div></div>
<h3>  Example 8: TCP Communication With Terminal </h3>
<p>In this example we'll show you how to send information from the WiFi shield to a PC terminal program. We'll make a simple Arduino console with menus that will give you the option to see the Arduino digital pin's state and toggle them.
</p><p><b> Step 1: Download a TCP Terminal </b>
</p><p><a href="http://sourceforge.net/projects/realterm/files/Realterm/2.0.0.70/Realterm_2.0.0.70_setup.exe/download">Download and install RealTerm</a>, a utility terminal that will allow us to connect to the WiFi shield.
</p><p><b> Step 2: Arduino Code </b>
</p><p>Upload the code below to your Arduino board replacing "mySSID", "myPassword", and authentication code with your own access point's information:
</p>
<div class="mw-geshi mw-code mw-content-ltr container" dir="ltr"><div class="arduino source-arduino"><pre class="de1"><span class="co2">#include &lt;SoftwareSerial.h&gt;</span>
<span class="co2">#include "WiFly.h"</span>
 
<span class="co2">#define SSID      "mySSID"</span>
<span class="co2">#define KEY       "myPassword"</span>
<span class="co1">// check your access point's security mode, mine was WPA20-PSK</span>
<span class="co1">// if yours is different you'll need to change the AUTH constant, see the file WiFly.h for avalable security codes</span>
<span class="co2">#define AUTH      WIFLY_AUTH_WPA2_PSK</span>
 
<span class="co2">#define FLAG_MAIN_MENU 1</span>
<span class="co2">#define FLAG_SUB_MENU_2 2</span>
 
 
<span class="kw4">int</span> flag <span class="sy1">=</span> FLAG_MAIN_MENU<span class="sy4">;</span>
 
<span class="co1">// Pins' connection</span>
<span class="co1">// Arduino       WiFly</span>
<span class="co1">//  2    &lt;----&gt;    TX</span>
<span class="co1">//  3    &lt;----&gt;    RX</span>
 
<span class="kw2">SoftwareSerial</span> wiflyUart<span class="br0">(</span><span class="nu0">2</span>, <span class="nu0">3</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// create a WiFi shield serial object</span>
WiFly wifly<span class="br0">(</span><span class="sy3">&amp;</span>wiflyUart<span class="br0">)</span><span class="sy4">;</span> <span class="co1">// pass the wifi siheld serial object to the WiFly class</span>
 
<span class="kw4">void</span> <span class="kw2">setup</span><span class="br0">(</span><span class="br0">)</span> 
<span class="br0">{</span>
 
  <span class="co1">// define the pins we can control</span>
  <span class="kw3">pinMode</span><span class="br0">(</span><span class="nu0">11</span>,<span class="kw2">OUTPUT</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="kw3">digitalWrite</span><span class="br0">(</span><span class="nu0">11</span>,<span class="kw2">LOW</span><span class="br0">)</span><span class="sy4">;</span>
 
  <span class="kw3">pinMode</span><span class="br0">(</span><span class="nu0">12</span>,<span class="kw2">OUTPUT</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="kw3">digitalWrite</span><span class="br0">(</span><span class="nu0">12</span>,<span class="kw2">LOW</span><span class="br0">)</span><span class="sy4">;</span>
 
  <span class="kw3">pinMode</span><span class="br0">(</span><span class="nu0">13</span>,<span class="kw2">OUTPUT</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="kw3">digitalWrite</span><span class="br0">(</span><span class="nu0">13</span>,<span class="kw2">LOW</span><span class="br0">)</span><span class="sy4">;</span>
 
  <span class="kw3">pinMode</span><span class="br0">(</span><span class="nu0">7</span>,<span class="kw2">OUTPUT</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="kw3">digitalWrite</span><span class="br0">(</span><span class="nu0">7</span>,<span class="kw2">LOW</span><span class="br0">)</span><span class="sy4">;</span>
 
 
  wiflyUart.<span class="kw3">begin</span><span class="br0">(</span><span class="nu0">9600</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// start wifi shield uart port</span>
 
  <span class="kw2">Serial</span>.<span class="kw3">begin</span><span class="br0">(</span><span class="nu0">9600</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// start the arduino serial port</span>
  <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"--------- TCP Communication --------"</span><span class="br0">)</span><span class="sy4">;</span>
 
  <span class="co1">// wait for initilization of wifly</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">1000</span><span class="br0">)</span><span class="sy4">;</span>
 
  wifly.<span class="me1">reset</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// reset the shield </span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">1000</span><span class="br0">)</span><span class="sy4">;</span>
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"set ip local 80<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// set the local comm port to 80</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">100</span><span class="br0">)</span><span class="sy4">;</span>
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"set comm remote 0<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// do not send a default string when a connection opens</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">100</span><span class="br0">)</span><span class="sy4">;</span>
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"set comm open *<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// set the string or character that the wifi shield will output when a connection is opened "*"</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">100</span><span class="br0">)</span><span class="sy4">;</span>
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"set ip protocol 2<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// set TCP protocol</span>
  <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">100</span><span class="br0">)</span><span class="sy4">;</span>
 
  <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Join "</span> SSID <span class="br0">)</span><span class="sy4">;</span>
  <span class="kw1">if</span> <span class="br0">(</span>wifly.<span class="me1">join</span><span class="br0">(</span>SSID, KEY, AUTH<span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"OK"</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span>
    <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"Failed"</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="br0">}</span>
 
  wifly.<span class="me1">sendCommand</span><span class="br0">(</span><span class="st0">"get ip<span class="es1">\r</span>"</span><span class="br0">)</span><span class="sy4">;</span>
  <span class="kw4">char</span> c<span class="sy4">;</span>
 
  <span class="kw1">while</span> <span class="br0">(</span>wifly.<span class="kw3">receive</span><span class="br0">(</span><span class="br0">(</span>uint8_t <span class="sy2">*</span><span class="br0">)</span><span class="sy3">&amp;</span>c, <span class="nu0">1</span>, <span class="nu0">300</span><span class="br0">)</span> <span class="sy1">&gt;</span> <span class="nu0">0</span><span class="br0">)</span> <span class="br0">{</span> <span class="co1">// print the response from the get ip command</span>
    <span class="kw2">Serial</span>.<span class="kw3">print</span><span class="br0">(</span><span class="br0">(</span><span class="kw4">char</span><span class="br0">)</span>c<span class="br0">)</span><span class="sy4">;</span>
  <span class="br0">}</span>
 
  <span class="kw2">Serial</span>.<span class="kw3">println</span><span class="br0">(</span><span class="st0">"TCP Ready"</span><span class="br0">)</span><span class="sy4">;</span>
 
 
 
<span class="br0">}</span>
 
<span class="kw4">void</span> <span class="kw2">loop</span><span class="br0">(</span><span class="br0">)</span> 
<span class="br0">{</span>
 
  <span class="kw1">if</span><span class="br0">(</span>wifly.<span class="kw3">available</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> 
  <span class="br0">{</span> 
    <span class="kw3">delay</span><span class="br0">(</span><span class="nu0">1000</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// wait for all the characters to be sent to the WiFi shield</span>
    <span class="kw4">char</span> val <span class="sy1">=</span> wiflyUart.<span class="kw3">read</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// read the first character</span>
 
    <span class="kw1">if</span><span class="br0">(</span>flag <span class="sy1">==</span> FLAG_MAIN_MENU<span class="br0">)</span>
    <span class="br0">{</span>
          <span class="kw1">switch</span><span class="br0">(</span>val<span class="br0">)</span>
          <span class="br0">{</span>
            <span class="kw1">case</span> <span class="st0">'*'</span><span class="sy4">:</span> <span class="co1">// search for the new connection string</span>
              printMainMenu<span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
            <span class="kw1">break</span><span class="sy4">;</span>
            <span class="kw1">case</span> <span class="st0">'1'</span><span class="sy4">:</span> <span class="co1">// the user typed 1, display the pin states</span>
             printPinStates<span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
             printMainMenu<span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
            <span class="kw1">break</span><span class="sy4">;</span>
            <span class="kw1">case</span> <span class="st0">'2'</span><span class="sy4">:</span> <span class="co1">// the user typed 2, display the sub menu (option to select a particular pin)</span>
             printSubMenu2<span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
            flag <span class="sy1">=</span> FLAG_SUB_MENU_2<span class="sy4">;</span> <span class="co1">// flag to enter the sub menu</span>
            <span class="kw1">break</span><span class="sy4">;</span>
            <span class="kw1">default</span><span class="sy4">:</span>
            wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"INVALID SUBMENU<span class="es1">\r</span><span class="es1">\n</span>"</span><span class="br0">)</span><span class="sy4">;</span>
            <span class="kw1">break</span><span class="sy4">;</span>
          <span class="br0">}</span>
    <span class="br0">}</span>
    <span class="kw1">else</span> <span class="kw1">if</span><span class="br0">(</span>flag <span class="sy1">==</span> FLAG_SUB_MENU_2<span class="br0">)</span>
    <span class="br0">{</span>
        <span class="kw4">int</span> pinNumber <span class="sy1">=</span> val<span class="sy2">-</span><span class="nu0">48</span><span class="sy4">;</span> <span class="co1">// get first number i.e. if the pin 13 then the 1st number is 1</span>
        <span class="kw4">int</span> secondNumber <span class="sy1">=</span> <span class="br0">(</span>wiflyUart.<span class="kw3">read</span><span class="br0">(</span><span class="br0">)</span><span class="sy2">-</span><span class="nu0">48</span><span class="br0">)</span><span class="sy4">;</span>
        <span class="kw1">if</span><span class="br0">(</span>secondNumber<span class="sy1">&gt;=</span><span class="nu0">0</span> <span class="sy3">&amp;&amp;</span> secondNumber<span class="sy1">&lt;=</span><span class="nu0">9</span><span class="br0">)</span>
        <span class="br0">{</span>
          pinNumber<span class="sy2">*</span><span class="sy1">=</span><span class="nu0">10</span><span class="sy4">;</span>
          pinNumber <span class="sy2">+</span><span class="sy1">=</span>secondNumber<span class="sy4">;</span> <span class="co1">// get second number, i.e. if the pin number is 13 then the 2nd number is 3, then add to the first number</span>
        <span class="br0">}</span>
 
        <span class="co1">// Create the "You want to toggle pin x ? OK..." string.</span>
        String response <span class="sy1">=</span> <span class="st0">"<span class="es1">\r</span><span class="es1">\n</span>You want to toggle pin "</span><span class="sy4">;</span>
        response<span class="sy2">+</span><span class="sy1">=</span>pinNumber<span class="sy4">;</span>
        response<span class="sy2">+</span><span class="sy1">=</span><span class="st0">"? OK...<span class="es1">\r</span><span class="es1">\n</span>"</span><span class="sy4">;</span>
 
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span>response<span class="br0">)</span><span class="sy4">;</span>
 
        <span class="kw3">digitalWrite</span><span class="br0">(</span>pinNumber, <span class="sy3">!</span><span class="kw3">digitalRead</span><span class="br0">(</span>pinNumber<span class="br0">)</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// toggle pin </span>
 
        wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"Pin Toggled!<span class="es1">\r</span><span class="es1">\n</span>"</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// let user know the pin was toggled.</span>
        printMainMenu<span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
        flag <span class="sy1">=</span> FLAG_MAIN_MENU<span class="sy4">;</span>
    <span class="br0">}</span>
 
  <span class="br0">}</span>
 
<span class="br0">}</span>
 
<span class="coMULTI">/**
* Prints the main menu options
*/</span>
<span class="kw4">void</span> printMainMenu<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
  wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"<span class="es1">\r</span><span class="es1">\n</span><span class="es1">\r</span><span class="es1">\n</span>"</span><span class="br0">)</span><span class="sy4">;</span>
  wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"Arduino Console Menu: <span class="es1">\r</span><span class="es1">\n</span>"</span><span class="br0">)</span><span class="sy4">;</span>
  wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"1. Show digital pin states<span class="es1">\r</span><span class="es1">\n</span>"</span><span class="br0">)</span><span class="sy4">;</span>
  wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"2. Toggle a digital pin's state<span class="es1">\r</span><span class="es1">\n</span>"</span><span class="br0">)</span><span class="sy4">;</span>
  wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"<span class="es1">\r</span><span class="es1">\n</span><span class="es1">\r</span><span class="es1">\n</span>"</span><span class="br0">)</span><span class="sy4">;</span>
<span class="br0">}</span>
 
<span class="co1">// displays the pin states</span>
<span class="kw4">void</span> printPinStates<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
 
    String pinState <span class="sy1">=</span> <span class="st0">"Pin 7 is "</span><span class="sy4">;</span>
    pinState<span class="sy2">+</span><span class="sy1">=</span>getPinState<span class="br0">(</span><span class="nu0">7</span><span class="br0">)</span><span class="sy4">;</span>
    pinState<span class="sy2">+</span><span class="sy1">=</span><span class="st0">"<span class="es1">\r</span><span class="es1">\n</span>"</span><span class="sy4">;</span>
 
    pinState <span class="sy2">+</span><span class="sy1">=</span> <span class="st0">"Pin 11 is "</span><span class="sy4">;</span>
    pinState<span class="sy2">+</span><span class="sy1">=</span>getPinState<span class="br0">(</span><span class="nu0">11</span><span class="br0">)</span><span class="sy4">;</span>
    pinState<span class="sy2">+</span><span class="sy1">=</span><span class="st0">"<span class="es1">\r</span><span class="es1">\n</span>"</span><span class="sy4">;</span>
 
    pinState <span class="sy2">+</span><span class="sy1">=</span> <span class="st0">"Pin 12 is "</span><span class="sy4">;</span>
    pinState<span class="sy2">+</span><span class="sy1">=</span>getPinState<span class="br0">(</span><span class="nu0">12</span><span class="br0">)</span><span class="sy4">;</span>
    pinState<span class="sy2">+</span><span class="sy1">=</span><span class="st0">"<span class="es1">\r</span><span class="es1">\n</span>"</span><span class="sy4">;</span>
 
    pinState <span class="sy2">+</span><span class="sy1">=</span> <span class="st0">"Pin 13 is "</span><span class="sy4">;</span>
    pinState<span class="sy2">+</span><span class="sy1">=</span>getPinState<span class="br0">(</span><span class="nu0">13</span><span class="br0">)</span><span class="sy4">;</span>
    pinState<span class="sy2">+</span><span class="sy1">=</span><span class="st0">"<span class="es1">\r</span><span class="es1">\n</span>"</span><span class="sy4">;</span>
 
    wiflyUart.<span class="kw3">print</span><span class="br0">(</span>pinState<span class="br0">)</span><span class="sy4">;</span>
<span class="br0">}</span>
 
<span class="co1">// prints the option to enter a pin number</span>
<span class="kw4">void</span> printSubMenu2<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
  wiflyUart.<span class="kw3">print</span><span class="br0">(</span><span class="st0">"<span class="es1">\r</span><span class="es1">\n</span>Enter the pin number you wish to toggle: "</span><span class="br0">)</span><span class="sy4">;</span>
<span class="br0">}</span>
 
<span class="co1">// get a pin state as a string.</span>
String getPinState<span class="br0">(</span><span class="kw4">int</span> pinNumber<span class="br0">)</span>
<span class="br0">{</span>
  <span class="kw1">if</span><span class="br0">(</span><span class="kw3">digitalRead</span><span class="br0">(</span>pinNumber<span class="br0">)</span><span class="br0">)</span> <span class="co1">// check if the pin is ON or OFF</span>
  <span class="br0">{</span>
    <span class="kw1">return</span> <span class="st0">"ON"</span><span class="sy4">;</span> <span class="co1">// the pin is on</span>
  <span class="br0">}</span>
  <span class="kw1">else</span>
  <span class="br0">{</span>
    <span class="kw1">return</span> <span class="st0">"OFF"</span><span class="sy4">;</span>  <span class="co1">// the pin is off</span>
  <span class="br0">}</span> 
<span class="br0">}</span></pre></div></div>
<p><b> Step 3: Obtain the Shield's IP Address and Port </b>
</p><p>Open the Arduino serial monitor window to obtain the WiFiShield's IP address and port number, highlighted in the image below.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:417px;"><img src="img/Tcp-arduino-serial-comm.png" width="415"/> <div class="thumbcaption">Arduino serial monitor window output from TCP example, the ip address and port number are highlighted.</div></div></div></div>
<p>In the image above the IP Address and Port would be the following:
</p>
<pre>
192.168.0.10:80
</pre>
<p><b> Step 4: Configure The TCP Terminal and Connect to The Shield </b>
</p><p>Open RealTerm and in the "Display" tab enter "30" for "Rows" and select the "Scrollback" option:
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:517px;"><img src="img/Realterm-display-tab.png" width="515"/> <div class="thumbcaption">RealTerm window: rows = 30, and Scrollback option checked.</div></div></div></div>
<p>In the "Port" tab of the RealTerm program, type your shield's IP address and port e.g. 192.168.0.10:80, then click the "Open" button, the Arduino's hard coded main menu should display in the terminal.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:530px;"><img src="img/Realterm-port-tab.png" width="528"/> <div class="thumbcaption">RealTerm window. Port field has WiFi shield's IP address and port number. The Arduino's menu is displayed</div></div></div></div>
<p>In the "Send" tab select one of the options from the menu either "1" or "2", enter it in the text box and press "Send ASCII" to send the value.
</p><p>For example, to toggle pin 13 enter "2" and press "Send ASCII", then when prompted "Enter the pin number you wish you toggle" enter "13" and click "Send ASCII". The Arduino should reply "Pin Toggled!" and go back to the main menu, now enter "1" and press "Send ASCII" to see the present state of the pins.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:530px;"><img src="img/Realterm-send-tab.png" width="528"/> <div class="thumbcaption">RealTerm window. The state of pin 13 was changed from OFF to ON as shown in the yellow text.</div></div></div></div>
<h3>  Example 9: WiFi Shield and Relay Shield </h3>
<p>Now that you know how to send and receive information to and from the WiFi shield you can see how easy it would be to control any kind of device via the web. 
</p><p>If you wish to control high power devices such as your desk lamp, a motor, or a water pump via a webpage or phone application we recommend our <a href="/Relay_Shield_V2.0">Relay Shield V2.0</a>. 
</p><p>The Relay Shield V2.0 uses pins 4, 5, 6, and 7 so it is fully compatible with the code in the examples in this page.
</p><p><br/>
</p>
<h3>  Example 10: Adhoc Mode </h3>
<p>To use the shield in Adhoc mode, as an access point, simply connect pin IO9 from the shield to the 3.3V pin in the Arduino, as shown below, and reset the shield if it was on.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:602px;"><img src="img/Wifi-shield-adhoc-mode-hardware-connection.png" width="600"/> <div class="thumbcaption">Shield connection required for adhoc mode. Pin IO9 of the shiled connected to 3.3V.</div></div></div></div>
<p>To obtain the shield's SSID upload the code in Example 1 to your Arduino and open the serial monitor, the shield will respond with it's SSID as in the example below, where in this case <b>WiFly-EZX-1b</b> is the SSID.
</p>
<pre>
AP mode as WiFly-EZX-1b on chan 1
</pre>
<p>You should now be able to connect to your WiFi shield as an access point, for example the SSID should be visible in your PC's list of WiFi networks available.
</p><p>To learn more about adhoc mode check out the <a href="res/WiFly-RN-UM.pdf">WiFly RN User Manual</a> section 16 "Adhoc Networking Mode"
</p>
<h2>  Related Reading </h2>
<ul><li> <a href="/Seeeduino_v3.0">What is a Seeeduino</a><br/>
</li><li> <a href="http://www.w3schools.com/">w3schools</a> Great website to learn HTML, Javascript, and JQuery<br/>
</li></ul>
<h2>  Resources </h2>
<ul><li> <a href="res/Wifi_shield_v1.2_eagle.zip">WiFi Shield v1.2 Eagle Files</a>
</li><li> <a href="res/Wifi_Shield_V1.2_schematic.pdf">Wifi Shield v1.2 schematic PDF</a>
</li><li> <a href="res/WiFly-RN-171.pdf">RN-171 Datasheet</a>
</li><li> <a href="https://github.com/Seeed-Studio/WiFi_Shield">Wifi Shield Library</a>
</li><li> <a href="res/WiFly-RN-UM.pdf">WiFi Module User Manual</a> - This is where you'll find all the commands for the RN-171 module in the shield.
</li></ul>
<h2>  Support </h2>
<ul><li><a href="http://www.seeedstudio.com/forum/">Forum</a>: <i>Please visit our forum and post your questions here if you have any problem about products. </i>
</li><li><a href="http://support.seeedstudio.com/knowledgebase/articles/456737-wifi-shield">FAQ about Wifi Shield</a>. <i>Click here to see if your questions have been solved. </i><br/>
</li></ul>
<h2>  Licensing  </h2>
<p>This documentation is licensed under the Creative Commons <a href="http://creativecommons.org/licenses/by-sa/3.0/">Attribution-ShareAlike License 3.0</a> Source code and libraries are licensed under <a href="http://www.gnu.org/licenses/gpl.html">GPL/LGPL</a>, see source code files for details.<br/>
</p>
Copyright (c) 2008-2016 Seeed Development Limited (<a href="http://www.seeedstudio.com">www.seeedstudio.com</a> / <a href="http://www.seeed.cc">www.seeed.cc</a>)<h6>This static html page was created from http://www.seeedstudio.com/wiki</h6></div></body></html>